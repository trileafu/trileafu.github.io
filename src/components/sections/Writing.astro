---
import { getCollection } from "astro:content";

const allPosts = await getCollection("blog");
const posts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 6)
	.map((post) => ({
		title: post.data.title,
		summary: post.data.description,
		category: post.data.category || "misc",
		date: post.data.pubDate.toISOString().split("T")[0],
		slug: post.slug,
	}));
---

<div class="container" id="writing">
	<div
		class="sticky top-8 pt-7 mt-1 pb-4 px-4 rounded-br-2xl h-fit bg-white z-10 left-0 -translate-x-4 w-fit"
	>
		<h2
			class="bg-blue-100 text-xl outline-1 outline-blue-900 py-2 px-4 w-fit rounded-xs rounded-br-2xl"
		>
			writing
		</h2>
	</div>

	<div class="space-y-4">
		<p class="text-center">
			i write <b>blog articles</b> about my interest.
		</p>
		<div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3">
			{
				posts.map((post) => (
					<a href={post.slug}>
						<article class="flex flex-col gap-3 rounded-lg border border-gray-200 bg-white p-5 shadow-sm transition hover:-translate-y-1 hover:shadow-md">
							<div class="flex items-center justify-between text-sm text-gray-600">
								<span class="font-semibold text-gray-800">{post.date}</span>
								<div class="flex flex-wrap gap-2">
									<span class="rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
										{post.category}
									</span>
								</div>
							</div>
							<div class="space-y-2">
								<h3 class="text-lg font-bold leading-tight text-gray-900">
									{post.title}
								</h3>
								<p class="text-gray-700">{post.summary}</p>
							</div>
							<div class="inline-flex justify-center items-center gap-2 text-blue-700 font-semibold hover:text-blue-900">
								read
								<span aria-hidden="true">→</span>
							</div>
						</article>
					</a>
				))
			}
		</div>
		<div class="flex justify-center">
			<a
				href="/blog"
				class="inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-5 py-2 text-sm font-semibold text-blue-800 transition hover:border-blue-200"
			>
				view more
				<span aria-hidden="true">→</span>
			</a>
		</div>
	</div>
</div>
