---
import { getCollection } from "astro:content";

const allPosts = await getCollection("blog");
const posts = allPosts
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 6)
	.map((post) => ({
		title: post.data.title,
		summary: post.data.description,
		category: post.data.category,
		date: post.data.pubDate,
		slug: post.slug,
	}));
---

<div class="container" id="writing">
	<div
		class="sticky top-8 pt-7 mt-1 pb-4 px-4 rounded-br-2xl h-fit bg-white z-10 left-0 -translate-x-4 w-fit"
	>
		<h2
			class="bg-blue-100 text-xl outline-1 outline-blue-900 py-2 px-4 w-fit rounded-xs rounded-br-2xl"
		>
			writing
		</h2>
	</div>

	<div class="space-y-4">
		<p class="text-center">
			i write <b>blog articles</b> about my interest.
		</p>
		<div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3">
			{
				posts.map((post) => (
					<a href={`/${post.slug}`} class="block h-full">
						<article class="flex flex-col gap-3 h-full rounded-xl border border-gray-200 bg-white p-5 shadow-sm transition-all duration-300 hover:shadow-md hover:-translate-y-1">
							<div class="flex items-center justify-between text-sm text-gray-500">
								<time class="lowercase" datetime={post.date.toISOString()}>
									{post.date.toLocaleDateString("en-US", {
										year: "numeric",
										month: "long",
										day: "numeric",
									})}
								</time>
								<div class="flex flex-wrap gap-2">
									<span class="rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
										{post.category}
									</span>
								</div>
							</div>
							<div class="flex-grow space-y-2">
								<h3 class="text-xl font-bold leading-tight text-gray-900 font-serif">
									{post.title}
								</h3>
								<p class="text-gray-600 leading-relaxed text-sm">
									{post.summary}
								</p>
							</div>
							<div class="pt-4 mt-auto text-trileafu-darker font-bold">
								read →
							</div>
						</article>
					</a>
				))
			}
		</div>
		<div class="flex justify-center">
			<a
				href="/blog"
				class="inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-5 py-2 text-sm font-semibold text-trileafu-darker transition hover:border-trileafu-darker"
			>
				view more
				<span aria-hidden="true">→</span>
			</a>
		</div>
	</div>
</div>
