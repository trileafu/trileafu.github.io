---
import Layout from "@/layouts/Layout.astro";
import Navbar from "@/components/Navbar.astro";
import Footer from "@/components/Footer.astro";
import Particles from "astro-particles";
import { getParticlesOptions } from "@/lib/particlesOptions";
import leaf from "@/assets/leaf.svg";
import { getCollection } from "astro:content";
import Logo from "@/components/Logo.astro";

const options = getParticlesOptions(leaf.src);
const posts = (await getCollection("blog")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<script>
	import { type Engine } from "tsparticles-engine";
	import { loadSlim } from "tsparticles-slim";

	window.particlesInit = async (engine: Engine) => {
		await loadSlim(engine);
	};
</script>

<Layout>
	<div class="flex flex-col min-h-screen">
		<main class="container mx-auto px-4 py-24 flex-1">
			<div
				class="rounded-2xl rounded-b-xs overflow-clip flex items-center bg-trileafu-background text-trileafu-alt mb-8"
			>
				<Logo />
				<div class="pb-7 w-full md:w-fit">
					<a
						href="/"
						class="md:mb-4 block items-center gap-2 rounded-full rounded-br-none bg-trileafu px-3 py-1 text-xs md:text-sm font-semibold text-trileafu-background transition-all hover:pl-8"
					>
						‚Üê homepage
					</a>
					<div class="mt-3 md:mt-7 font-serif font-bold text-2xl md:text-8xl">
						trileafu's
						<span
							class="bg-trileafu p-2 md:p-4 rounded-xs rounded-br-xl text-trileafu-background"
						>
							blog
						</span>
					</div>
				</div>
			</div>

			<div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
				{
					posts.map((post) => (
						<a href={`/${post.slug}`} class="block h-full">
							<article class="flex flex-col gap-3 h-full rounded-xs rounded-br-xl border border-gray-200 bg-white p-5 shadow-sm transition hover:scale-95 hover:shadow-md">
								<div class="flex items-center justify-between text-sm text-gray-500">
									<time
										class="lowercase"
										datetime={post.data.pubDate.toISOString()}
									>
										{post.data.pubDate.toLocaleDateString("en-US", {
											year: "numeric",
											month: "long",
											day: "numeric",
										})}
									</time>
									{post.data.category && (
										<span class="rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
											{post.data.category}
										</span>
									)}
								</div>
								<div class="space-y-2 flex-grow">
									<h3 class="text-xl font-bold leading-tight text-gray-900 font-serif">
										{post.data.title}
									</h3>
									<p class="text-gray-600 line-clamp-3 leading-relaxed text-sm">
										{post.data.description}
									</p>
								</div>
								<div class="pt-4 mt-auto flex items-center text-trileafu-darker font-medium group">
									read
									<svg
										xmlns="http://www.w3.org/2000/svg"
										class="h-4 w-4 ml-1 transition-transform group-hover:translate-x-1"
										fill="none"
										viewBox="0 0 24 24"
										stroke="currentColor"
									>
										<path
											stroke-linecap="round"
											stroke-linejoin="round"
											stroke-width="2"
											d="M14 5l7 7m0 0l-7 7m7-7H3"
										/>
									</svg>
								</div>
							</article>
						</a>
					))
				}
			</div>
		</main>
		<Footer />
	</div>
</Layout>
